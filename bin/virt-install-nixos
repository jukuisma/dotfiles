#!/usr/bin/env bash

CPUS="${CPUS:=4}"
DISK="${DISK:=20}"
RAM="${RAM:=8192}"

domain="$1"

virt-install \
    --name "$domain" \
    --ram "$RAM" --vcpus "$CPUS" \
    --disk size="$DISK" \
    --os-variant nixos-24.05 \
    --graphics none \
    --boot uefi,nvram_template=/usr/share/edk2/ovmf/OVMF_VARS.fd \
    --cdrom /var/lib/libvirt/images/nixos-minimal.iso
