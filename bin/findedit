#!/usr/bin/env bash

if [ "$#" -ne 1 ]; then
    echo "1 parameter only: e.g.: findedit 'File contains This Text'"
    exit 1
fi

searchterm="$1"
file=$(
    rg -l "$searchterm" | \
    fzf \
        --preview "bat --style=header,grid --color=always --line-range :300 {}" \
        --height 70% \
        --bind ctrl-u:preview-half-page-up,ctrl-d:preview-half-page-down \
        --preview-window=bottom,80%
)

if [ -n "$file" ]; then
    nvim "$file"
fi
